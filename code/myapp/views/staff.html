<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>员工信息</title>
<!--    <link rel="stylesheet" type="text/css" href="../../stylesheets/select.css"/>-->
    <link rel="stylesheet" type="text/css" href="../../stylesheets/table.css"/>

    <meta charset="UTF-8">
    <script type="text/javascript" language="javascript">
        var idTmr;
        function  getExplorer() {
            var explorer = window.navigator.userAgent ;
            if(explorer.indexOf("Chrome") >= 0){
                return 'Chrome';
            }else{
                alert("非chrome浏览器");
                return false;
            }
        }
        function method1(tableid) {//整个表格拷贝到EXCEL中
            tableToExcel('tableId')
        }
        var tableToExcel = (function(tableId) {
            //设置类型
            var uri = 'data:application/vnd.ms-excel;base64,',
                template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
                //base64加密处理
                base64 = function(s) {
                    return window.btoa(unescape(encodeURIComponent(s)))
                },
                //格式化处理
                format = function(s, c) {
                    return s.replace(/{(\w+)}/g,
                        function(m, p) {
                            return c[p];
                        }
                    )
                };
            //自动执行
            return function(tableId, name) {
                var aLink=document.getElementById("dlink");
                var table = document.getElementById(tableId);
                // 获取表单的名字和表单查询的内容
                var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML};
                // format()函数：通过格式操作使任意类型的数据转换成一个字符串
                // base64()：进行编码
                aLink.href = uri + base64(format(template, ctx))
                aLink.download="test.xls";
                aLink.click();
            }
        })()
    </script>
</head>
<body background="../../images/001.png" style="background-repeat:no-repeat;background-size:100% 100%;background-attachment:fixed;">
<form action="/ass" method="post">
    <div id="header">
        <div class="logo">员工信息</div>
        <div class="navigation">
            <ul>
                <li><a href="/users/uadd">新增员工</a></li>
            </ul>
        </div>
    </div>
    <div class="tablebox" style="width: 100%;height: 380px; margin-top:80px;">
    <table  id="tableId" border="0" cellspacing="0" cellpadding="0">
        <tr align="center">
            <th>序号</th>
            <th>公司名称</th>
            <th>职位</th>
            <th>员工</th>
            <th>账号</th>
            <th>密码</th>
            <th>删除功能</th>
            <th>修改功能</th>
        </tr>
        {% for item in datas %}
        <tr align="center">
            <td>{{item.id}}</td>
            <td>{{item.company}}</td>
            <td>{{item.position}}</td>
            <td>{{item.uname}}</td>
            <td>{{item.account}}</td>
            <td>{{item.password}}</td>
            <td><a href="/users/del/{{item.id}}" onclick="return confirm('您确认要删除本记录么？')">删除</a></td>
            <td><a href="/users/toUpdate/{{item.id}}">修改</a></td>
        </tr>
        {% endfor %}
    </table>
    </div>

</form>
<a id="dlink" style="display: none;"></a>
<input type="submit" value="导出EXCEL" onclick="method1('tableId')" />
</body>
</html>
<SCRIPT Language=VBScript></SCRIPT>