<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>会员管理</title>
    <!--    <link rel="stylesheet" type="text/css" href="../../stylesheets/select.css"/>-->
<!--    <link rel="stylesheet" type="text/css" href="../../stylesheets/table.css"/>-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../../stylesheets/table.css"/>
    <script type="text/javascript" src="../../iframe_d/iframe_d.js"></script>
    <script type="text/javascript" src="../../js/jquery-1.8.3.min.js"></script>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        html,
        body {
            height: 100%;
        }

        #app {
            height: 100%;
        }

        li {
            list-style: none;
        }

        .leftnav {
            width: 5%;
            background-color: #1DBce0;
            height: 100%;
            float: left;
        }

        .leftnav li {
            width: 100%;
            height: 65px;
            text-align: center;
            line-height: 65px;
            border-bottom: 1px solid white;
            color: white;
        }

        .order {
            width: 30%;
            float: left;
            position: relative;
        }

        .order .order-nav {
            border-bottom: 1px solid black;
            overflow: hidden;
            /*  浮动的隐藏 */
        }

        .order-nav li {
            width: 60px;
            height: 42px;
            float: left;
            text-align: center;
            line-height: 42px;
        }

        .order-nav .active {
            color: #1DBce0;
        }

        .order .border {
            width: 60px;
            height: 3px;
            background-color: #1DBce0;
            position: absolute;
            top: 39px;
            transition: left 0.5s;
            /*过渡动画*/
        }

        .oftergoods,
        .typegoods {
            width: 65%;
            float: right;
        }

        .oftergoods {
            overflow: hidden;
        }

        .oftergoods h3 {
            height: 42px;
            border-bottom: 1px solid black;
            line-height: 42px;
        }

        .oftergoods ul {
            padding-top: 30px;
            padding-left: 50px;
        }

        .oftergoods ul li {
            width: 120px;
            height: 38px;
            float: left;
            background-color: antiquewhite;
            border: 1px solid blue;
            margin-right: 30px;
            margin-bottom: 30px;
            line-height: 38px;
            text-align: center;
            padding: 4px;
        }

        .typegoods {
            position: relative;
        }

        .typegoods .typegoods-nav {
            border-bottom: 1px solid black;
            overflow: hidden;
            /*  浮动的隐藏 */
            margin-bottom: 30px;
        }

        .typegoods-nav li {
            width: 60px;
            height: 42px;
            float: left;
            text-align: center;
            line-height: 42px;
        }

        .typegoods-nav .active {
            color: #1DBce0;
        }

        .typegoods .border {
            width: 60px;
            height: 3px;
            background-color: #1DBce0;
            position: absolute;
            top: 39px;
            transition: left 0.5s;
            /*过渡动画*/
        }

        .typegoods .goods {
            width: 200px;
            height: 68px;
            border: 1px solid blue;
            float: left;
            margin-right: 30px;
            background-color: palegoldenrod;
        }

        .typegoods .goods img {
            width: 80px;
            height: 60px;
            float: left;
        }

        .typegoods .goods p {
            line-height: 60px;
        }
    </style>
</head>
<style>
    /* 公共 */

    body {
        padding: 0;
        margin: 0;
        background: #fff;
        overflow-y: scroll;
    }

    thead, tr, th, td {
        border: 0;
        margin: 0;
        padding: 0;
        vertical-align: baseline;
        height: 37px;
        line-height: 37px;
        color: #9c9c9c;
    }

    a {
        text-decoration: none;
        color: #000;
    }

    ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .index {
        display: flex;
        height: 100%;
        width: 100%;
        background-color: #f7f7f7;
    }

    .Lmenu {
        width: 20px;
        /*background: rgb(62, 35, 236);*/
    }

    .Lmenu .left {
        display: flex;
        flex-flow: column;
        min-height: 100vh;
        background: rgb(62, 35, 236);
    }

    .Lmenu ul li {
        text-align: center;
        margin-top: 14px;
        height: 68px;
        border-bottom: 1px solid #fff;
    }

    .Lmenu ul li a {
        color: #fff;
    }

    .Lmenu ul li .img {
        width: 50%;
        margin: 0 auto;
    }

    .Lmenu ul li img {
        width: 100%;
    }

    .Lblock {
        /*flex:1;*/
        /*width: 350px;*/
        /*margin-left: 10px;*/
        /*margin-right: 10px;*/
        /*min-height: 600px;*/
        flex: 2;
        display: flex;
        flex-direction: column;
        height: 100%;
        min-width: 320px;
        margin-right: 10px;
        color: #9c9c9c;
    }

    .Lblock table{
        table-layout: fixed;
    }

    .table{
        width: 100%;
        max-width: 100%;
        text-align: center;
    }

    table{
        border-collapse: collapse;
        border-spacing: 0;
    }

    .Lblock .room_info{
        height: 50px;
        display: flex;
    }

    .Lblock .title{
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
    }

    .Lblock .title .itemOrderNO，
    .Lblock .cont .table tbody .itemOrderNO{
        text-align: center;
        width: 50px;
    }

    .Lblock .title .itemName，
    .Lblock .cont .table tbody .itemName{
        text-align:left;
    }

    .Lblock .title .itemNum，
    .Lblock .cont .table tbody .itemNum{
        text-align: center;
        width: 60px;
    }

    .Lblock .title .itemAmount,
    .Lblock .cont .table tbody .itemAmount{
        text-align: right;
        width: 50px;
    }

    .Lblock .room_info h4{
        font-weight: 400;
        margin: 0 5px 0 12px;
        width: 155px;
        line-height: 50px;
        color: #9c9c9c;
    }
    .Lblock #empty_mask{
        flex: 1;
        overflow: hidden;
    }

    .Lblock .menu ul {
        display: flex;
        border-bottom: 2px solid darkgrey;
    }

    .Lblock .menu ul li {
        font-size: 14px;
        margin-right: 50px;
        margin-top: 5px;
        line-height: 45px;
        text-align: center;
        border-bottom: 2px solid darkgrey;
        margin-bottom: -2px;
    }

    .Lblock .menu ul li.hover {
        border-bottom: 2px solid rgb(49, 0, 247);
    }

    .Lblock .menu ul li.hover a {
        color: rgb(32, 32, 246);
    }

    .Lblock .menu ul li:hover {
        border-bottom: 2px solid rgb(49, 0, 247);
    }

    .Lblock .menu ul li:hover a {
        color: rgb(32, 32, 246);
    }

    .Lblock .table {
        margin-top: 1px;
        /*height: 87%;*/
    }

    .Lblock .table .title {
        display: flex;
        margin-top: 10px;
    }

    .Lblock .table .title li {
        width: 100%;
        border: 1px solid darkgrey;
        border-left: none;
        border-right: none;
        height: 50px;
        font-size: 16px;
        font-weight: bold;
        line-height: 50px;
        text-align: center;
        /* padding-left: 8px; */
        color: #606060;
    }

    .Lblock #empty_mask .cont .table tbody tr{
        height: 62px;
        color: #000;
    }

    .Lblock #empty_mask .cont > table tbody tr{
        cursor: pointer;
    }

    /*.table-hover>tbody>tr:nth-of-type(odd){*/
    /*    background-color: #f9f9f9;*/
    /*}*/


    /*.Lblock .table .title li:last-child {*/
    /*    border-right: 1px solid darkgrey;*/
    /*}*/

    .Lblock #empty_mask .cont {
        /* width: 107%; */
        overflow-y: auto;
        height: 100%;
        /* width: calc(100% + 17px);*/
    }

    .Lblock #empty_mask .cont table{
        table-layout: fixed;
    }

    .Lblock .table .cont li {
        display: flex;
        background-color: lime;
        color: white;
    }

    .Lblock .cont li div {
        width: 100px;
        border: 1px solid darkgrey;
        border-right: 0;
        border-top: 0;
        height: 30px;
        line-height: 30px;
        padding-left: 8px;
        color: #606060;
        display: flex;
    }

    .Lblock .table .cont li div:last-child {
        border-right: 1px solid darkgrey;
    }

    .Lblock .table .cont li span {
        width: 22px;
        text-align: center;
        cursor: pointer;
        margin: 6px 5px;
        color: white;
        background-color: #ea2929;
        border-radius: 50%;
        font-size: 6px;
        font-weight: 600;
        border: 1px solid white;
        line-height: 13px;
        transition: .3s;
    }
    .Lblock .table .cont li span:hover{
        color: #ea2929;
        background-color: white;
        border: 1px solid #ea2929;
    }

    .Lblock .end {
        margin-top: 8px;
        padding: 9px 10px;
        height: 38px;
        font-size: 15px;
        display: flex;
        color: #222;
        border-top: 1px solid #f5f5f5;
        justify-content: space-between;
    }
    .Lblock .end span{
        color: red;
    }

    .Lblock .end .count,
    .Lblock .end .price_total{
        color: red;
    }

    .Lblock .button {
        display: flex;
        justify-content: center;
        margin-top: 10px;
        flex-direction: row;
        height: 50px;
    }

    .Lblock .button button {
        height: 42px;
        line-height: 42px;
        width: 72px;
        text-align: center;
        border: 0px;
        border-radius: 5px;
        cursor: pointer;
        margin: 0 10px;
        font-size: 16px;
    }

    .Lblock .button .but1 {
        color: #fff;
        background: rgb(231 192 63);
    }

    .Lblock .button .but2 {
        color: #fff;
        transition: .3s;
        flex: 0 50%;
        background-color: #ff0000b8;
        border-radius: 10px;
        box-shadow: 0px 5px 8px rgb(0 0 0 / 20%);
        font-weight: normal;
    }

    .Lblock .button > button{
        margin-bottom: 10px;
        width: 100%;
        height: 40px;
        line-height: 40px;
        padding: 0;
        background-color: #FFCF3D;
        font-weight: bold;
    }

    /*.Lblock .button .but2:hover{*/
    /*    color: rgb(246 103 103);*/
    /*    background-color: #5e5e5e;*/
    /*    border: 1px solid rgb(246 103 103);*/
    /*}*/

    .Lblock .button .but3 {
        color: #fff;
        transition: .3s;
        background-color: #0aa0f6;
        border-radius: 10px;
        box-shadow: 0px 5px 8px rgb(0 0 0 / 20%);
        font-weight: normal;
    }

    /*.Lblock .button .but3:hover{*/
    /*    color: rgb(3 199 43);*/
    /*    background-color: #fff;*/
    /*    border: 1px solid rgb(3 199 43);*/
    /*}*/
    .index >div{
        padding: 10px;
        background-color: #ffffff;
        border: 1px solid #ececec;
        border-radius: 5px;
    }

    .btn{
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-size: 14px;
        font-weight: normal;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        -ms-touch-action: manipulation;
        touch-action: manipulation;
        cursor: pointer;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        background: #04b9e1;
        border: 1px solid transparent;
        margin-right: 10px;
        border-radius: 5px;
        width: 120px;
        height: 34px;
    }

    .btns{
        flex: 1;
        max-width: 130px;
        margin-right: 10px;
    }

    .btns>div{
        margin-top: 10px;
        height: 40px;
    }

    .btns button{
        width: 100%;
        height: 40px;
        line-height: 40px;
        padding: 0;
        background-color: #E8E9EE;
        font-weight: normal;
        font-size: 16px
    }

    hr {
        margin-top: 20px;
        margin-bottom: 20px;
        border: 0;
        border-top: 1px solid #eee;
    }

    .btns .jia{
        width: 100%;
        height: 40px;
        line-height: 40px;
        padding: 0;
        background-color: #E8E9EE;
        font-weight: normal;
        font-size: 16px;
    }

    .Rblock {
        flex: 7;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
    }

    body{
        /*background: url(" ");*/
    }

    .Rblock .head {
        height: 50px;
        line-height: 50px;
        padding-left: 10px;
        border-bottom: 1px solid darkgray;
    }

    .Rblock .option {
        display: flex;
        margin: 10px;
        font-size: 14px;
        flex-wrap: wrap;
    }

    .Rblock .option li {
        cursor: pointer;
        padding: 0 10px;
        height: 36px;
        line-height: 36px;
        text-align: center;
        border: 1px solid darkgrey;
        margin: 5px;
    }

    .Rblock .Bmenu {
        position: relative;
        display: flex;
        margin-top: 19px;
        margin-left: 19px;
        height: 53px;
        width: 97%;
        /* border-bottom: 2px solid #0AA0F6; */
        background-color: #0AA0F6;
        box-shadow: 0px 5px 8px rgb(10 160 246 / 30%);
        border-radius: 12px;
    }

    .Rblock .Bmenu .preMenu{
        /*flex: 1;*/
        position:absolute;
        left: 5px;
        width: 35px;
        height: 35px;
        margin: 0 5px;
        line-height: 55px;
    }
    .Rblock .Bmenu .nextMenu{
        /*flex: 1;*/
        width: 35px;
        height: 35px;
        position: absolute;
        right: 5px;
        line-height: 55px;
    }
    .Rblock .Bmenu .menu{
        /*flex: 7;*/
    }

    .Rblock .Bmenu li {
        margin-right: 38px;
        margin-bottom: -2px;
    }

    .Rblock .Bmenu .hover {
        line-height: 36px;
        padding: 8px 2px;
        transition: .3s;
    }

    /*.Rblock .Bmenu li.hover:hover{*/
    /*    !*background-color: #077027;*!*/
    /*    !*border-bottom: 2px solid lime;*!*/
    /*}*/

    .Rblock .Bmenu .hover .menuType {
        /*color: rgb(32, 32, 246);*/
        color: white;
        font-size: 17px;
        font-weight: 400;
        padding: 7px 20px;
        background-color: #0AA0F6;
        border-radius: 17px;
        transition: .3s;
    }

    .menuType-active{
        background-color: #ffffff;!important;
        color: #0AA0F6;!important;
    }
    /*.Rblock .Bmenu li.hover a:hover{*/
    /*    color: white;*/
    /*    background-color: #077027;*/
    /*}*/
    /*active{*/
    /*    color: white;*/
    /*    background-color: #077027;*/
    /*}*/

    /*.Rblock .Bmenu li:hover {*/
    /*    border-bottom: 2px solid rgb(49, 0, 247);*/
    /*}*/

    /*.Rblock .Bmenu li:hover a {*/
    /*    color: rgb(32, 32, 246);*/
    /*}*/

    .Rblock .Bmenu li:first-child {
        margin-left: 33px;

    }

    .Rblock .block {
        display: flex;
        flex-wrap: wrap;
        margin-top: 11px;
        margin-left: 10px;
        width: 98%;
    }

    .Rblock .block li {
        display: flex;
        border: 1px solid darkgrey;
        width: 217px;
        min-height: 72px;
        margin: 5px 5px 10px;
        cursor: pointer;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 5px 6px 13px rgb(0 0 0 / 50%);
        transition: .3s;
        font-weight: 400;
    }
    .Rblock .block li:hover{
        transform: translateY(-5px);
    }

    .Rblock .block li .img {
        width: 55%;
    }

    .Rblock .block li img {
        width: 100%;
    }

    .product_details{
        width: 48%;
        font-size: 20px;
        justify-content: space-between;
        padding: 8px;
    }

    .Rblock .block li .title {
        color: rgb(0, 0, 0);
        margin-left: 10px;
        margin-top: 14px;
    }

    .Rblock .block li .money {
        margin-top: 36px;
        margin-right: 0;
        color: rgb(255, 0, 0);
    }

    #empty_mask {
        /*border-left: 1px solid darkgrey;*/
        /*border-right: 1px solid darkgrey;*/
        text-align: center;
        line-height: 72px;
        height: 75%;
        text-align: center;
        line-height: 23em;
        color: darkgrey;
    }

    .room_info #danhao{
        height: 36px;
        transition: .3s;
        margin-top: 8px;
        font-size: 20px;
        border: none;
    }

    .room_info #danhao:focus{
        outline: #006eb0;
    }

    .Lblock .table .cont li div.none {
        display: none;
    }

    .none {
        display: none;
    }

    .form_input{
        width: 180px;
        height: 30px;
        outline: none;
        /*border: 1px solid #b7aec7;*/
        border-radius: 3px;
        padding-left: 8px;
        font-size: 19px;
        margin-top: 11px;
        border: none;
    }


</style>

<body>
<div class="index">
<!--    <input type="hidden" value="{{datas2 }}" id="datas2">-->
<!--    <div class="Lmenu">-->
<!--    </div>-->

    <div class="Lblock">
<!--        <div class="menu">-->
<!--            <ul>-->
<!--            </ul>-->
<!--        </div>-->
<!--        <div class="table">-->
        <div class="room_info">
            <h4>消费单号：</h4>
            <div class="input_order" style="width: 300px;">
                <input class="form_input" id="danhao" name="danhao" value="888888888888888"/>
            </div>
        </div>
<!--           <div class="title">-->
<!--               <li style="border-radius:15px 0px 0px 0px">商品名称</li>-->
<!--               <li>数量</li>-->
<!--               <li>金额</li>-->
<!--               <li style="border-radius:0px 15px 0px 0px">操作</li>-->
<!--           </div>-->
        <div class="title">
            <table class="table">
                <thead>
                    <tr>
                        <td class="itemOrderNO">序号</td>
                        <td class="itemName">商品名称</td>
                        <td class="itemNum">数量</td>
                        <td class="itemAmount">金额</td>
                    </tr>
                </thead>
            </table>
        </div>
        <div id="empty_mask">
            <div class="cont">
                <table id="table" class="table table-hover">
                    <tbody>
<!--                        //自动添加商品-->
                    </tbody>
                </table>
            </div>
        </div>
<!--        <div class="end">-->
<!--            <div>-->
<!--                合计数量:-->
<!--                <span class="count">0</span>-->
<!--            </div>-->
<!--            <div>-->
<!--                合计金额:-->
<!--                <span>-->
<!--                    ￥-->
<!--                    <span class="price_total">-->
<!--                        0.00-->
<!--                    </span>-->
<!--                </span>-->

<!--            </div>-->
<!--        </div>-->
<!--        </div>-->
        <div class="button">
            <button class="but2" btnflag="cancel">作废</button>
            <button class="but3">结账</button>
        </div>
    </div>
    <div class="btns">
        <div>
            <button id="jia" class="btn jia">+</button>
        </div>
        <div>
            <button id="jian" class="btn jian">-</button>
        </div>
<!--        <div>-->
<!--            <button class="btn">数量</button>-->
<!--        </div>-->
<!--        <div>-->
<!--            <button class="btn price">修改价格</button>-->
<!--        </div>-->
<!--        <div>-->
<!--            <button class="btn">做法</button>-->
<!--        </div>-->
<!--        <div>-->
<!--            <button class="btn del_this_td">删除</button>-->
<!--        </div>-->
<!--        <div>-->
<!--            <button class="btn is_zengsong">赠送</button>-->
<!--        </div>-->
<!--        <div>-->
<!--            <button class="btn orderStaff">下单员工</button>-->
<!--        </div>-->
<!--        <hr>-->
<!--        <div>-->
<!--            <button class="btn">修改账单</button>-->
<!--        </div>-->
    </div>
    <div class="Rblock">
        <div class="Bmenu">
            <div class="preMenu">
<!--                <img src="../public/images/new_pics/上一页.png">-->
            </div>
            {% for item in types %}
            <div class="menu">
                <li class="hover">
                    <a href="#" class="menuType">{{item.type}}</a>
                </li>
            </div>
            {% endfor %}
            <div class="nextMenu">
<!--                <img src="../public/images/new_pics/下一页.png">-->
            </div>
        </div>
        <ul class="block">

            {% for item in datas %}
            <li>
                <div class="img">
                    <img src="{{item.photo}}" alt="">
                </div>
                <div class="product_details">
                    <div class="title">
                        {{item.product_name}}
                    </div>
                    <div class="money">￥<span>{{item.price}}</span>元</div>
                </div>
                <div class="none id">{{item.id}}</div>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>
<script>
    let datas = []
    let p_zhekou = 1

    window.onload = function() {
        tableShow();
    }

    $(document).ready(function(){
        Table_sum();
    })

    // 给加号添加点击事件
    // $(document).delegate('.jia', "click", function () {
    //     // var money = $(this).parent().parent().children().eq(4); //价格
    //     // var Smoney = $(this).parent().parent().children().eq(3); //总价格
    //     var count = $("#empty_mask .cont .table tr .itemNum"); //数量
    //     var money = $("#empty_mask .cont .table tr .itemAmount");//单价
    //     // var Smoney = $(".price_total"); //一个tr的总价格
    //
    //     count.text(parseInt(count.text()) + 1)
    //     // Smoney.text((money.text() * 1)*parseInt(count.text() * 1));
    //     var Smoney = parseInt((money.text() * 1))*parseInt(count.text() * 1);
    //     console.log(Smoney);
    //     Table_sum();
    // });

    // 给减号添加点击事件
    // $(document).delegate('.jian', "click", function () {
    //     // var _this = $(this).parent().parent().children().eq(2); //数量
    //     var count = $(this).parent().parent().siblings(".Lblock").children(".title").children(".itemNum");
    //     // var money = $(this).parent().parent().children().eq(4); //价格
    //     var Smoney = $(this).parent().parent().children().eq(3); //总价格
    //
    //     if (parseInt(_this.text()) - 1 <= 0) {
    //         var _length = $(this).parent().parent().parent().children().length - 1;
    //         $(this).parent().parent().remove();
    //         if (_length <= 0) {
    //             $(".table .cont").attr("style", "display:none");
    //             $("#empty_mask").attr("style", "display:block");
    //         }
    //         Table_sum();
    //     }
    //     else {
    //         _this.text(parseInt(_this.text()) - 1)
    //         Smoney.text((money.text() * 1)*(_this.text() * 1));
    //         Table_sum();
    //     }
    // });

    // $("body").on('click','.Rblock .block li',function(){
    //     var _this = $(this).children();
    //     var _id = _this.eq(3).text();
    //     console.log(_id)
    //     var existence = false;
    //     $(".Lblock #empty_mask .cont .table tbody tr").each(function () {
    //         var id = $(this).children().eq(0).text();
    //         if (_id == id) {
    //             existence = true;
    //             $(this).children().eq(2).text(parseInt($(this).children().eq(2).text()) + 1);
    //             $(this).children().eq(3).text(($(this).children().eq(4).text() * 1)*($(this).children().eq(2).text() * 1));
    //             Table_sum();
    //         }
    //     })
    //
    //     if (!existence) {
    //         var _str = "<li><div class='none'>%1%</div><div>%2%</div><div>1</div><div>%3%</div><div class='none'>%4%</div><div style='justify-content: center;padding:0 4px;'><span class='jia'>+</span><span class='jian'>-</span></div></li>";
    //         _str = _str.replace("%1%", _this.eq(3).text());
    //         _str = _str.replace("%2%", _this.eq(1).text());
    //         _str = _str.replace("%3%", _this.eq(2).children().text());
    //         _str = _str.replace("%4%", _this.eq(2).children().text());
    //         $(".Lblock .table .cont").append(_str);
    //         $("#empty_mask .cont").attr("style", "display:block");
    //         // $("#empty_mask").attr("style", "display:none");
    //         Table_sum();
    //     }
    // });

    //右边菜单栏点击事件,显示出对应类型的商品
    $(".Rblock .Bmenu li").click(function () {
        //获取li下面的a链接
        var _this = $(this).children();
        //获取a链接里面的文字
        var type = _this.eq(0).text();
        console.log(type)
        var this_str = ""
        for(var i=0; i<datas.length; i++){
            if(datas[i].type == type){
                var num = datas[i].price * p_zhekou//商品价格*折扣
                console.log('折扣='+p_zhekou)//当前商品折扣为1
                num = Math.floor(num * 100) / 100;//该类型下的商品价格
                console.log('num='+num)
                //所要显示的商品价格
                this_str += "" +
                    "<li>" +
                        "<div class=\"img\">" +
                            "<img src=\"{{datas[i].photo}}\" alt=\"\">" +
                        "</div>" +
                        "<div class=\"product_details\">"+
                            "<div class=\"title\">\n" +
                                "" + datas[i].product_name  +
                            "</div>" +
                            "<div class=\"money\">￥<span>" + num + "</span>元</div>" +
                        "</div>"+
                        "<div class=\"none id\">" + datas[i].id + "</div>" +
                    "</li>"
            }
        }

        $(".Rblock .block li").attr("style","display:none;");
        $(".Rblock .block").append(this_str);

    })
    //给菜单类型按钮添加点击变换样式
    $('.Rblock .Bmenu li .menuType').on('click',function(){
        $(this).addClass("menuType-active").siblings().removeClass("menuType-active");
    })
    //给选中商品添加点击样式并进行增加减少和删除的操作
    $('.Lblock #empty_mask .cont .table tbody tr').click(function (){
        //产品id
        var product_id = $(this).children().eq(0).text();
        //产品个数
        var product_count = $(this).children().eq(2).children().eq(1).text();
        //产品单价 个数乘单价(datas[i].price)
        // var product_money = $(this).children().eq(3).children().eq(0).text();
        var product_money = datas[product_id].price*product_count;
        //声明一个数组用来接收
        //  var product_arr[] = null;

        // $(this).children.addClass("menuType-active").siblings().removeClass("menuType-active");
        // console.log(product_id.text(),product_count.text(),product_money.text(),product_td_Smoney.text())
        for(var i =0; i<=$(this).length;i++){
            if (parseInt(($(this).index()+1)) == parseInt(product_id)){
                $(".index .btns.jia").click(function (){
                    parseInt(parseInt(product_count)+parseInt("1"));
                    product_money += product_money;
                })
                $(".index .btns.jian").click(function (){
                    parseInt(parseInt(product_count.text())-parseInt("1"));
                    product_money += product_money;
                })
                $(".index .btns.del_this_td").click(function (){
                    $(this).index(parseInt(parseInt(product_id)-parseInt("1"))).remove();
                })
            }
        }
    })
    //--------------------------------
    //点击商品后，.Lblock #empty_mask .cont tbody下加tr
    // $(".Rblock .block li").click(function (){
    //     //单点一份的1
    //     var num = 1;
    //     //新增商品的序号
    //     var product_now_id = parseInt($(".index .Lblock #empty_mask .cont .table tbody tr").length+parseInt("1"));
    //     //获取添加商品链接的id
    //     var product_id = $(this).children(".id").text();
    //     console.log(product_id);
    //     var this_str = ""
    //     for(var i = 0; i < datas.length; i++){
    //         if(datas[i].id == product_id){
    //             //所要显示的商品价格
    //             this_str += "" +
    //                 "<tr class=\"success\">" +
    //                     "<td class=\"itemOrderNo\">" + product_now_id+ "</td>" +
    //                     "<td class=\"itemName\">" + datas[i].product_name + "</td>"+
    //                     "<td class=\"itemNum\">" +
    //                         "<span class=\"count\">" + num + "</span>"+
    //                         "/"+
    //                         "<span class=\"unit\">" + datas[i].unit + "</span>"+
    //                     "</td>"+
    //                     "<td class=\"itemAmount\">" +
    //                         "￥"+
    //                         "<span class=\"price\">" + datas[i].price + "</span>"+
    //                     "</td>"+
    //                 "</tr>"
    //         }
    //     }
    //     $(".Lblock #empty_mask .table tbody").append(this_str);
    // })


    $("body").on('click','.Rblock .block li',function(){
        //单点一份的1
        var num = 1;
        //新增商品的序号
        var product_now_id = parseInt($(".index .Lblock #empty_mask .cont .table tbody tr").length+parseInt("1"));
        //获取添加商品链接的id
        var product_id = $(this).children(".id").text();
        console.log(product_id);
        var this_str = ""
        for(var i = 0; i < datas.length; i++){
            if(datas[i].id == product_id){
                //所要显示的商品价格
                this_str += "" +
                    "<tr class=\"success\">" +
                    "<td class=\"itemOrderNo\">" + product_now_id+ "</td>" +
                    "<td class=\"itemName\">" + datas[i].product_name + "</td>"+
                    "<td class=\"itemNum\">" +
                    "<span class=\"count\">" + num + "</span>"+
                    "/"+
                    "<span class=\"unit\">" + datas[i].unit + "</span>"+
                    "</td>"+
                    "<td class=\"itemAmount\">" +
                    "￥"+
                    "<span class=\"price\">" + datas[i].price + "</span>"+
                    "</td>"+
                    "</tr>"
            }
        }
        $(".Lblock #empty_mask .table tbody").append(this_str);
    });

    $("body").on('click','.success',function(){
        //单点一份的1
        console.log('dd')
        $('.success').css('background-color', 'white');
        $(this).css('background-color', '#f9f9f9');
    });

    $("body").on('click','#jia',function(){
        //单点一份的1
        console.log('jia')

        $("#table tbody tr").each(function(){
            var a = $(this).css('background-color');
            if(a == 'rgb(249, 249, 249)'){
                console.log('选中')
                var count = $(this).children().eq(2).children().eq(0);
                var this_count = $(this).children().eq(2).children().eq(0).text();
                var money = $(this).children().eq(3);
                var this_money = $(this).children().eq(3).text();
                this_money = this_money.replace("￥","")
                console.log(count)
                console.log(this_count)
                console.log(money)
                console.log(this_money)
                var danjia = this_money / this_count
                this_count = this_count * 1 + 1 * 1
                this_money = this_money * 1 + danjia * 1
                console.log(this_count)
                console.log(this_money)
                count.text(this_count)
                money.text("￥" + this_money)
            }
        });

    });

    $("body").on('click','#jian',function(){
        //单点一份的1
        console.log('jian')
        $("#table tbody tr").each(function(){
            var a = $(this).css('background-color');
            if(a == 'rgb(249, 249, 249)'){
                console.log('选中')
                var count = $(this).children().eq(2).children().eq(0);
                var this_count = $(this).children().eq(2).children().eq(0).text();
                var money = $(this).children().eq(3);
                var this_money = $(this).children().eq(3).text();
                this_money = this_money.replace("￥","")
                console.log(count)
                console.log(this_count)
                console.log(money)
                console.log(this_money)
                var danjia = this_money / this_count
                this_count = this_count * 1 - 1 * 1
                this_money = this_money * 1 - danjia * 1
                console.log(this_count)
                console.log(this_money)
                count.text(this_count)
                money.text("￥" + this_money)
                if(this_count < 1){
                    $(this).remove();
                }
            }
        });
    });

    // 给加号添加点击事件
    // $(document).delegate('.jia', "click", function () {
    //     // var money = $(this).parent().parent().children().eq(4); //价格
    //     // var Smoney = $(this).parent().parent().children().eq(3); //总价格
    //     var count = $("#empty_mask .cont .table tr .itemNum"); //数量
    //     var money = $("#empty_mask .cont .table tr .itemAmount");//单价
    //     // var Smoney = $(".price_total"); //一个tr的总价格
    //
    //     count.text(parseInt(count.text()) + 1)
    //     // Smoney.text((money.text() * 1)*parseInt(count.text() * 1));
    //     var Smoney = parseInt((money.text() * 1))*parseInt(count.text() * 1);
    //     console.log(Smoney);
    //     Table_sum();
    // });

    //--------------------------------


    // 作废按钮点击后
    $(".but2").click(function () {
        console.log("delete")
        $(".Lblock #empty_mask .cont .table tbody tr").remove();
        // $(".Lblock #empty_mask .cont .table tbody").attr("style", "display:none");
        // $("#empty_mask").attr("style", "display:block");
        // $(".Lblock #empty_mask .cont .table tbody").attr("style", "display:block");
        Table_sum();
    })
    // 结账按钮点击后
    $(".but3").click(function () {
        console.log("add")
        var pro_list = []
        var pro_num = $("#danhao").val();
        $(".Lblock #empty_mask .cont .table tbody tr").each(function () {
            var id = $(this).children().eq(0).text();
            var num = $(this).children(".itemNum").children().eq(0).text();
            var zhehou = $(this).children(".itemAmount").children().eq(1).text();
            console.log(id)
            console.log(num)
            console.log(zhehou)
            for(var i=0; i<datas.length;i++){
                if(datas[i].id == id){
                    pro_list.push({
                        cplx:datas[i].type,
                        cpmc:datas[i].product_name,
                        dw:datas[i].unit,
                        dj:datas[i].price,
                        dzbl:p_zhekou,
                        // zhdj:zhehou / num,
                        zhdj:datas[i].price*p_zhekou,
                        // zhje:zhehou,
                        zhje:datas[i].price*p_zhekou*num,
                        gs:num
                    })
                }
            }
        })
        console.log(pro_list)
        console.log(pro_num)
        if(pro_num == ''){
            alert("未填写订单号")
            return;
        }
        if(pro_list.length == 0){
            alert("未选择商品")
            return;
        }
        $(".hover").click(function (){
            $(".hover").removeClass("active")
            $(".hover").addClass("active")
        })

        $.ajax({
            type: 'post',
            url: '/order_panel/add',
            timeout: 5000,
            data: {
                pro_list: JSON.stringify(pro_list),
                pro_num: pro_num,
                youhui: p_zhekou
            },
            success: function(res){
                let result = JSON.parse(res)
                alert(result.msg)
                tableShow();
            },
            error: function(res){
                if(res.status == "timeout"){
                    alert("网络超时，请稍后再试")
                }else{
                    alert("网络错误，请稍后再试")
                }
            }
        });
    })

    //改过了--------------
    //合计商品数量和价格
    //完成了
    function Table_sum(){
        var _number = 0;
        var _money = 0;
        $(".Lblock #empty_mask .cont .table tbody tr").each(function () {
            var number = $(this).children().eq(2).children().eq(0).text();
            var money = $(this).children().eq(3).children(".price").text();
            _number += (number * 1);
            _money += (money * 1);
        })
        // console.log('当前money='+_money);
        $(".Lblock .end").children().eq(0).children(".count").text(_number);
        $(".Lblock .end").children().eq(1).children().children(".price_total").text(_money);

    }

    function tableShow(){
        $.ajax({
            type: 'post',
            url: '/order_panel/select',
            async:false,
            timeout: 5000,
            success: function(res){
                //转成json
                let result = JSON.parse(res)
                console.log(result)
                datas = result.datas
                console.log(datas)
                let users = result.users
                console.log(users)
                if(users.usertype == '客户'){
                    $.ajax({
                        type: 'post',
                        url: '/order_panel/select_discount',
                        async:false,
                        timeout: 5000,
                        success: function(res){
                            let result = JSON.parse(res)
                            console.log('客户金额和等级列表')
                            console.log(result)
                            var zhekou = 1
                            var zhekou_list = result.dengji
                            var xiaofei = result.xiaoji_sum
                            if(xiaofei == null){
                                xiaofei = 0
                            }
                            for(var i=0; i<zhekou_list.length; i++){
                                console.log("门槛：" + zhekou_list[i].menkan * 1)
                                console.log("消费金额：" + xiaofei * 1)
                                if(zhekou_list[i].menkan * 1 <= xiaofei * 1){
                                    zhekou = zhekou_list[i].bili
                                }
                            }
                            console.log(zhekou)
                            p_zhekou = zhekou
                            var this_str = ""
                            console.log(datas)
                            for(var i=0; i<datas.length; i++){
                                var num = datas[i].price * zhekou
                                num = Math.floor(num * 100) / 100;
                                this_str = this_str + "<li><div class=\"img\"><img src=\"{{datas[i].photo}}\" alt=\"\"></div><div class=\"title\">\n" +
                                    "                    " + datas[i].product_name  +
                                    "                </div>" +
                                    "                <div class=\"money\">￥<span>" + num + "</span>元</div>" +
                                    "                <div class=\"none id\">" + datas[i].id + "</div>" +
                                    "            </li>"

                            }

                            $(".Rblock .block li").remove();
                            $(".Rblock .block").append(this_str);

                            $(".Lblock .table .cont li").remove();
                            $(".table .cont").attr("style", "display:none");
                            $("#empty_mask").attr("style", "display:block");
                            Table_sum();

                        },
                        error: function(res){
                            if(res.status == "timeout"){
                                alert("网络超时，请稍后再试")
                            }else{
                                alert("网络错误，请稍后再试")
                            }
                        }
                    });
                }
            },
            error: function(res){
                if(res.status == "timeout"){
                    alert("网络超时，请稍后再试")
                }else{
                    alert("网络错误，请稍后再试")
                }
            }
        });
    }

</script>
<!--<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>-->

<!--<div id="app">{{ message }}</div>-->

<!--<script>-->
<!--    const { createApp } = Vue-->

<!--    createApp({-->
<!--        data() {-->
<!--            return {-->
<!--                message: 'Hello Vue!'-->
<!--            }-->
<!--        }-->
<!--    }).mount('#app')-->
<!--</script>-->
</body>
</html>
<SCRIPT Language=VBScript></SCRIPT>